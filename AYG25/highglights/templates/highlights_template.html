<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ section_title }} | {{ group_label or 'AYG25' }}</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        :root { color-scheme: light; }
        * { box-sizing: border-box; }
        body {
            margin: 0;
            background: #e9e9ee;
            font-family: 'Montserrat', 'Helvetica Neue', Arial, sans-serif;
            color: #1f1f1f;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }
        .results-canvas {
            width: 1080px;
            height: 1920px;
            background: #f4f4f8;
            padding: 32px 40px;
            box-sizing: border-box;
            overflow-y: auto;
            border-radius: 28px;
            box-shadow: 0 18px 48px rgba(0, 0, 0, 0.12);
        }
        .results-section { max-width: 100%; margin: 0 auto; }
        .results-header {
            margin-bottom: 32px;
            padding: 24px 32px;
            background: #bd1e2d;
            color: #ffffff;
            border-radius: 20px;
            box-shadow: 0 14px 30px rgba(189, 30, 45, 0.28);
            text-transform: uppercase;
            letter-spacing: 0.12em;
        }
        .results-title {
            margin: 0;
            font-size: 30px;
            font-weight: 700;
        }
        .results-subtitle {
            margin: 10px 0 0;
            font-size: 13px;
            color: rgba(255, 255, 255, 0.85);
        }
        .results-generated {
            margin: 6px 0 0;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }
        .results-grid {
            display: grid;
            grid-template-columns: repeat(3, minmax(300px, 1fr));
            gap: 24px;
        }
        .results-carousel {
            position: relative;
        }
        .carousel-track {
            position: relative;
            width: 100%;
        }
        .carousel-slide {
            display: none;
        }
        .carousel-slide.active {
            display: block;
            animation: fadeIn 200ms ease-in;
        }
        .carousel-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: none;
            background: rgba(189, 30, 45, 0.9);
            color: #fff;
            font-size: 28px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 8px 20px rgba(189, 30, 45, 0.35);
            transition: transform 160ms ease, opacity 160ms ease;
        }
        .carousel-nav:hover {
            transform: translateY(-50%) scale(1.05);
        }
        .carousel-nav:disabled {
            opacity: 0.35;
            cursor: not-allowed;
            transform: translateY(-50%);
        }
        .carousel-nav.prev { left: -12px; }
        .carousel-nav.next { right: -12px; }
        .carousel-dots {
            margin-top: 18px;
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        .carousel-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(189, 30, 45, 0.25);
            border: none;
            cursor: pointer;
            transition: transform 160ms ease, background 160ms ease;
        }
        .carousel-dot.active {
            background: #bd1e2d;
            transform: scale(1.2);
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .result-card {
            display: flex;
            flex-direction: column;
            min-height: 240px;
            background: #fff;
            border-radius: 20px;
            box-shadow: 0 16px 40px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            position: relative;
        }
        .card-medal {
            position: absolute;
            top: 16px;
            right: 16px;
            font-size: 26px;
            filter: drop-shadow(0 6px 14px rgba(0, 0, 0, 0.18));
        }
        .card-header {
            padding: 16px 22px;
            background: linear-gradient(90deg, #d9382c 0%, #ba1b27 60%, #a51420 100%);
            color: #fff;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .card-header-title {
            margin: 0;
            font-size: 16px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }
        .card-tags {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }
        .card-tag {
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            background: rgba(255, 255, 255, 0.18);
            color: #fff;
            padding: 2px 6px;
            border-radius: 999px;
        }
        .card-main {
            flex: 1;
            padding: 22px 24px;
            display: flex;
            flex-direction: column;
        }
        .card-content {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .card-title {
            margin: 0;
            font-size: 14px;
            font-weight: 700;
            text-transform: uppercase;
            color: #111;
        }
        .card-athletes {
            margin: 0;
            font-size: 13px;
            font-weight: 600;
            color: #ba1b27;
        }
        .card-event {
            margin: 0;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: #4b4b4b;
        }
        .card-scoreboard {
            border-radius: 12px;
            background: #f9f9fb;
            padding: 10px 14px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .score-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 14px;
            flex-wrap: nowrap;
        }
        .score-row[data-role="primary"] { font-weight: 700; }
        .score-info {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
            min-width: 0;
        }
        .flag-circle {
            width: 42px;
            height: 28px;
            border-radius: 6px;
            background: #ffffff;
            box-shadow: inset 0 0 0 1px rgba(0,0,0,0.08);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        .flag-circle img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .flag-emoji {
            font-size: 21px;
            line-height: 1;
        }
        .flag-placeholder {
            display: inline-block;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #d3d3d3;
        }
        .score-meta { display: flex; flex-direction: column; gap: 2px; }
        .competitor-name { font-size: 12px; color: #1b1b1b; }
        .competitor-country {
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: #7a7a7a;
        }
        .score-value {
            font-size: 15px;
            font-weight: 700;
            min-width: 40px;
            text-align: right;
            color: #0f172a;
            margin-left: auto;
            padding: 6px 14px;
            border-radius: 12px;
            background: #eef0f6;
            flex-shrink: 0;
            white-space: nowrap;
            font-variant-numeric: tabular-nums;
        }
        .result-badge {
            align-self: flex-start;
            padding: 3px 9px;
            border-radius: 999px;
            background: #ba1b27;
            color: #fff;
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }
        @media (max-width: 1280px) {
            body { padding: 32px; }
            .results-grid { grid-template-columns: repeat(2, minmax(280px, 1fr)); }
        }
        @media (max-width: 1024px) {
            body { padding: 28px 24px; }
            .results-grid { grid-template-columns: repeat(2, minmax(260px, 1fr)); }
        }
        @media (max-width: 640px) {
            body { padding: 24px 16px; }
            .results-grid { grid-template-columns: 1fr; }
            .result-card { flex-direction: column; }
            .card-side {
                width: 100%;
                flex-direction: row;
                align-items: center;
                gap: 16px;
                padding: 18px;
            }
            .card-main { padding: 24px 20px; }
            .card-content { padding-right: 0; }
        }
    </style>
</head>
<body>
    <div class="results-canvas">
        <section class="results-section" aria-labelledby="results-title">
            <header class="results-header">
                <h2 class="results-title" id="results-title">{{ section_title }}</h2>
            </header>
            <div class="results-carousel" data-total-slides="{{ slides|length }}">
                <div class="carousel-track" id="results-carousel-track">
                    {% for slide in slides %}
                    <div class="carousel-slide{% if loop.first %} active{% endif %}" data-slide-index="{{ loop.index0 }}">
                        <div class="results-grid" data-layout="2x3">
                            {% for card in slide %}
                            <article class="result-card" data-card-index="{{ card.index }}">
                                {% if card.medal_label and card.medal_icon %}
                                <div class="card-medal" aria-label="{{ card.medal_label }}">{{ card.medal_icon }}</div>
                                {% endif %}
                                <div class="card-header">
                                    <h3 class="card-header-title">{{ card.sport }}</h3>
                                    {% if card.sport_tags %}
                                    <div class="card-tags">
                                        {% for tag in card.sport_tags %}
                                        <span class="card-tag">{{ tag }}</span>
                                        {% endfor %}
                                    </div>
                                    {% endif %}
                                </div>
                                <div class="card-main">
                                    <div class="card-content">
                                        <h4 class="card-title">{{ card.event_details }}</h4>
                                        <div class="card-scoreboard">
                                            {% for competitor in card.competitors %}
                                            <div class="score-row" data-role="{% if loop.index0 == 0 %}primary{% else %}opponent{% endif %}">
                                                <div class="score-info">
                                                    <div class="flag-circle">
                                                        {% if competitor.flag_image %}
                                                        <img src="{{ competitor.flag_image }}" alt="{{ competitor.flag_alt }}">
                                                        {% elif competitor.flag_icon %}
                                                        <span class="flag-emoji" aria-hidden="true">{{ competitor.flag_icon }}</span>
                                                        {% else %}
                                                        <span class="flag-placeholder"></span>
                                                        {% endif %}
                                                    </div>
                                                    <div class="score-meta">
                                                        <span class="competitor-name">{{ competitor.name }}</span>
                                                        <span class="competitor-country">{{ competitor.country }}</span>
                                                    </div>
                                                </div>
                                                {% if competitor.score %}
                                                <span class="score-value">{{ competitor.score }}</span>
                                                {% endif %}
                                            </div>
                                            {% endfor %}
                                        </div>
                                        {% if card.result_badge %}
                                        <span class="result-badge">{{ card.result_badge }}</span>
                                        {% endif %}
                                    </div>
                                </div>
                            </article>
                            {% endfor %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% if slides|length > 1 %}
                <button class="carousel-nav prev" id="results-carousel-prev" aria-label="Previous slide">‹</button>
                <button class="carousel-nav next" id="results-carousel-next" aria-label="Next slide">›</button>
                <div class="carousel-dots" id="results-carousel-dots">
                    {% for slide in slides %}
                    <button class="carousel-dot{% if loop.first %} active{% endif %}" data-slide="{{ loop.index0 }}" aria-label="Go to slide {{ loop.index }}"></button>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
        </section>
    </div>

    <script>
        (function() {
            const track = document.getElementById('results-carousel-track');
            if (!track) {
                return;
            }
            const slides = Array.from(track.querySelectorAll('.carousel-slide'));
            if (!slides.length) {
                return;
            }
            let currentIndex = 0;
            const prevBtn = document.getElementById('results-carousel-prev');
            const nextBtn = document.getElementById('results-carousel-next');
            const dotsContainer = document.getElementById('results-carousel-dots');
            const dots = dotsContainer ? Array.from(dotsContainer.querySelectorAll('.carousel-dot')) : [];
            
            function updateSlide(newIndex) {
                if (newIndex < 0 || newIndex >= slides.length) {
                    return;
                }
                slides[currentIndex].classList.remove('active');
                slides[newIndex].classList.add('active');
                currentIndex = newIndex;
                
                if (prevBtn) {
                    prevBtn.disabled = currentIndex === 0;
                }
                if (nextBtn) {
                    nextBtn.disabled = currentIndex === slides.length - 1;
                }
                if (dots.length) {
                    dots.forEach((dot, idx) => {
                        if (idx === currentIndex) {
                            dot.classList.add('active');
                        } else {
                            dot.classList.remove('active');
                        }
                    });
                }
            }
            
            if (prevBtn) {
                prevBtn.addEventListener('click', () => updateSlide(currentIndex - 1));
                prevBtn.disabled = true;
            }
            if (nextBtn) {
                nextBtn.addEventListener('click', () => updateSlide(currentIndex + 1));
                nextBtn.disabled = slides.length <= 1;
            }
            if (dots.length) {
                dots.forEach(dot => {
                    dot.addEventListener('click', () => {
                        const target = Number(dot.getAttribute('data-slide'));
                        updateSlide(target);
                    });
                });
            }
        })();
    </script>
</body>
</html>
